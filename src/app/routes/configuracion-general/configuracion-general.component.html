<div class="title">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header-danger">
        <h4 class="card-title">Configuración General</h4>
      </div>
    </div>
  </div>
</div>

<mat-tab-group dynamicHeight>
  <mat-tab label="Ajustes">
    <div class="box mat-elevation-z4">



    </div>
  </mat-tab>

  <mat-tab label="Facturación">
    <div class="box mat-elevation-z4">

      <div class="container-fluid d-flex justify-content-end align-items-start">

        <div class="alert alert-danger container-fluid" role="alert" *ngIf="!isConfigurated"
          style="margin-right: 1rem;">
          Cargue el certificado y llave privada para poder usar el servicio web de facturacion de AFIP.
        </div>

        <div class="alert alert-danger container-fluid" role="alert" *ngIf="!systemStatus" style="margin-right: 1rem;">
          Uno o varios sistemas de AFIP se encuentran en mantenimiento.
        </div>

        <div class="spinner-grow text-warning mx-2 mat-elevation-z1" role="status" *ngIf="loading"></div>

        <div class="spinner-grow text-danger mx-2 mat-elevation-z1" role="status" *ngIf="error || !systemStatus"></div>

        <span class="badge bg-success px-3 py-1 mx-1 mat-elevation-z3" *ngIf="online && !loading && systemStatus">
          <h3 class="p-0 m-0">Online</h3>
        </span>

        <span class="badge bg-secondary px-3 py-1 mx-1 mat-elevation-z3" *ngIf="!online && !loading">
          <h3 class="p-0 m-0">Offline</h3>
        </span>

      </div>

      <div class="form-group container-fluid mb-4">
        <p class="mb-1">Ingrese su certificado (.crt)</p>
        <input type="file" class="form-control" id="crtFile" #fileInput (change)="onFileSelected($event, 'crt')">
        <div class="text-danger m-2" *ngIf="errorMessageCrt">Solo se permiten archivos con extensión .crt</div>
      </div>

      <div class="form-group container-fluid mb-4">
        <p class="mb-1">Ingrese su llave (.key)</p>
        <input type="file" class="form-control" id="keyFile" #fileInput (change)="onFileSelected($event, 'key')">
        <div class="text-danger m-2" *ngIf="errorMessageKey">Solo se permiten archivos con extensión .key</div>
      </div>

      <div class="buttons justify-content-center">

        <button type="button" class="btn m-2 mb-2"
          [ngClass]="isConfigurated && !online? 'btn-outline-primary':'btn-outline-secondary'" (click)="iniciarSesion()"
          [disabled]="!isConfigurated || online">Iniciar sesión</button>

        <button type="button" class="btn m-2 mb-2 btn-outline-primary"
          (click)="dataService.fetchFacturacionAuth('GET')" (click)="consultarEstados()">Consultar</button>

        <button type="button" class="btn m-2 mb-2"
          [ngClass]="isConfigurated? 'btn-outline-warning':'btn-outline-secondary'" (click)="forzarToken()"
          [disabled]="!isConfigurated">Nuevo Token (Forzar)</button>


      </div>


    </div>
  </mat-tab>
</mat-tab-group>
